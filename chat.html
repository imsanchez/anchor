<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Anchor</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css" integrity="sha384-i/ZLCOBtDmoxztrtShNvc3vGe1+IbOGDzkZNC4KLXurv/BT7QInnM2AsPnvbgXH/" crossorigin="anonymous">
       
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.9/semantic.min.css" integrity="sha384-m1fl5JKXaEocK0a/l9MLZd7pvyIwC5VlcXtW8NpMLO/yO5WFDY4fB3/fweZ0niwK" crossorigin="anonymous">
        
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
       
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900">

     	<link rel="stylesheet" href="css/chat.css">
     	<link rel="stylesheet" href="css/bootstrap.css">

        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" integrity="sha384-bPV3mA2eo3edoq56VzcPBmG1N1QVUfjYMxVIJPPzyFJyFZ8GFfN7Npt06Zr23qts" crossorigin="anonymous"></script>

            <script src="js/bootstrap.js"></script>
    </head>
    <body>
    	<div class="ui wide massive sidebar inverted teal vertical menu">
            <a class="item">About Anchor</a>
            <a class="item">Local Agencies</a>
            <a class="item" href="tel:911">Call 911</a>
    	</div>
	  	<div class="pusher">
	        <header class="ui top fixed massive inverted borderless menu">
                <div class="nav-container menu">
	                <div class="logo item">
	                    <img src="images/logo-light.png" class="hidden-sm-down"/>
	                    <img src="images/icon-light.png" class="hidden-md-up"/>
	                </div>
	                <div class="right menu hidden-sm-down">
	                    <a class="item">About Anchor</a>
	                    <a class="item">Local Agencies</a>
	                    <a class="item" href="tel:911">Call 911</a>
	                </div>
	                <div class="right menu hidden-md-up">
	                    <a class="item" id="sidebar"><i class="material-icons">menu</i></a>
	                </div>
	            </div>
	        </header>
	        <section class="ui vertical basic very padded segment"> 
	            <div class="container">
	                <h2 class="ui medium primary header">
	                    Immediate Assistance 
	                    <div class="sub header">
	                        If this is an emergency call 911 immediately.
	                    </div>
	                </h2>
	                <a class="ui circular small secondary button" href="tel:911">
	                    Call 911
	                </a>
	            </div>
	        </section>
	        <section class="ui vertical basic very padded segment pt-0"> 
	            <div class="container">
	                <h2 class="ui medium primary header">
	                    Chat with ConEd
	                </h2>
	                <p class="rhythm">
                        Update: There are black outs in parts of lower Manhattan and parts of Brooklyn. We are working hard to restore power.
                    </p>
		            <div class="ui divider"></div>
		            <p class="text-muted" id="static">Only ConEd can see your responses.</p>
                    <div class="ui items" id="responses">
                    	
                   	</div>
		            <div class="ui teal divider"></div>
		            <p class="text-muted">
                        Communicate with ConEd with pre-programmed messages.
                    </p>
	            </div>
	            <div class="container text-center">
	            	<div class="ui vertical text menu mx-auto" id="messages">
	            		<div class="item">
			                <a class="ui circular small secondary button">
			                    No Power
			                </a>
		                </div>
		                <div class="item">
			                <a class="ui circular small secondary button">
			                    Send My Location
			                </a>
		                </div>
		                <div class="item">
			                <a class="ui circular small secondary button">
			                    Can I Go Outside?
			                </a>
		                </div>
		                <div class="item">
			                <a class="ui circular small secondary button">
			                    Gas Leak
			                </a>
		                </div>
		            </div>
	            	<div class="ui vertical text menu mx-auto">
		                <div class="item">
			                <a class="ui circular small alt button" href="everyday.html">
			                    Back to Home
			                </a>
		                </div>
	                </div>
	            </div>
	        </section>
	        <footer class="ui vertical basic inverted padded segment">
	            <div class="container">
	                <div class="row">
	                    <div class="col-6">
	                        Anchor.guide
	                    </div>
	                    <div class="col-6 text-right">
	                       Copyright 2017
	                    </div>
	                </div>
	            </div>
	        </footer>
	    </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.0/jquery.min.js" integrity="sha384-o9KO9jVK1Q4ybtHgJCCHfgQrTRNlkT6SL3j/qMuBMlDw3MmFrgrOHCOaIMJWGgK5" crossorigin="anonymous"></script>
        <script async defer src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.9/semantic.min.js" integrity="sha384-Ail6li4BXa+GztK4v0z2B8vXM69Kl5gw8vj3uPEna+3hHY9wAixO0hLotSJlOjlT" crossorigin="anonymous"></script>
        <script async defer src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDdZOHZxUTasVlFnoMk9U55zJN4ZAPfRVY"></script>
        <script>
            $(function(){
                $('.ui.radio.checkbox').checkbox();
                $('#sidebar').click(function() {
                	$('.ui.sidebar').sidebar('toggle');
                });
                $('#messages .item').each(function() {
                	$(this).find('a').click(function() {
                		var val = $.trim($(this).text());
                    	$('#static').fadeIn("slow", function() {
	                		$('<div style="display:none;" class="item d-block"><a class="ui circular small disabled button right floated">' + val + '</a></div>').appendTo($('#responses')).slideDown("slow", function() {
		                		if(val == 'No Power') {
		                			$('<div style="display:none;" class="item"><p><strong>Ok, could you please share your location?</strong></p></div>').appendTo($('#responses')).slideDown("slow");
		                		}else if(val == 'Send My Location') {
		                			$('<div style="display:none;" class="item"><p><strong>One second as I retrieve your location...</strong></p></div>').appendTo($('#responses')).slideDown("slow");
								        var geocoder = new google.maps.Geocoder;
								        if (navigator.geolocation) {
						                  	navigator.geolocation.getCurrentPosition(function(position) {
						                  		// Google Maps API convert to address here
							                    var pos = {
							                      lat: position.coords.latitude,
							                      lng: position.coords.longitude
							                    };
						                  		geocoder.geocode({'location': pos}, function(results, status) {
											        if (status === 'OK') {
											            if (results[1]) {
											                $('<div id="map" style="max-height:200px;"></div>').appendTo($('#responses'));

											                var map = new google.maps.Map(document.getElementById('map'), {
											                  center: {lat: 40.7590562, lng: -74.0042502},
											                  scrollwheel: false,
														      navigationControl: false,
														      mapTypeControl: false,
														      scaleControl: false,
														      draggable: false,
											                  zoom: 15
											                });

										                    map.setCenter(pos);
										                    new google.maps.Marker({map: map, position: pos});

											              $('<div style="display:none;" class="item"><p><strong>We have your location at ' + results[1].formatted_address + '.</strong></p></div>').appendTo($('#responses')).slideDown("slow");
											            } else {
											              window.alert('No results found');
											            }
										          	} else {
											            window.alert('Geocoder failed due to: ' + status);
										          	}
											    });
						                  	}, function() {
						                  		console.error('Error: The Geolocation service failed.');
						                  	});
						                } else {
						                	console.error('Error: Your browser doesn\'t support geolocation.');
						                }
		                		}else if(val == 'Can I Go Outside?') {
		                			$('<div style="display:none;" class="item"><p><strong>Currently it is not recommended. Emergencies only.</strong></p></div>').appendTo($('#responses')).slideDown("slow");
		                		}else if(val == 'Gas Leak') {
		                			$('<div style="display:none;" class="item"><p><strong>Please evacuate the premises, notify your landlord and share your location.</strong></p></div>').appendTo($('#responses')).slideDown("slow");
		                		}
	                		});
	                	});
                	});
                });
            });
        </script>
    </body>
</html>